from django.shortcuts import renderfrom django.http import HttpResponsefrom django.http import HttpResponseRedirectfrom django.db.models import Qfrom datetime import datetimefrom .models import Taskfrom django.shortcuts import render_to_response# Create your views here.def login(request):    if request.method=="POST":        username= request.POST.get('user','')        response = render_to_response('welcome.html')        response.set_cookie('u', username,3600)        response.set_cookie('time',datetime.now(),3600)        return response    elif request.COOKIES.get('u',''):        return HttpResponseRedirect('/home')    else:        return render(request, "login.html")def home(request):    if request.COOKIES.get('u',0): #user has been defined        #user = request.GET.get('u', 0) # url's user get higher priority        #if user:        user = request.COOKIES['u']        page = request.GET.get('p', 0)        today = datetime.today()        re = Task.objects.filter(            Q(userName=user) & Q(taskstatus=0) & Q(startTime__lte=today) & Q(endTime__gte=today))[50 * page:50 * (page + 1)]        response = render_to_response('home.html', {"items": re})        response.set_cookie('u', user, 3600)        return response    else:        return HttpResponseRedirect('/login')def addnew(request):    if request.method == 'POST':        taskName= request.POST.get('taskName')        taskType = request.POST['taskType']        userName = request.POST['userName']        startTime = request.POST['startTime']        endTime = request.POST['endTime']        Task.objects.create(			taskName=taskName,			taskType=taskType,			userName=userName,			startTime=startTime,			endTime=endTime)        return render(request,'form.html',{'notes':'add succeed!'})    else:        return render(request,'form.html')def finish(request):    if request.method == 'POST':        id = int(request.POST.get('id',0))        if id :            Task.objects.filter(id=id).update(taskstatus=1)            return render(request,'finish.html',{'notes':"Task has been finished"})    return render(request,'finish.html')